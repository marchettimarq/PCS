<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>easyPCS</title>
  <meta name="theme-color" content="#2563eb">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon.png">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Sticky App Bar -->
  <header id="appBar" class="app-bar" role="banner">
    <div class="bar-left">
      <button id="backBtn" class="btn-link back" aria-label="Back to Home" title="Back" hidden>← Home</button>
    </div>
    <h1 id="appTitle" class="app-title" tabindex="-1" aria-live="polite">easyPCS</h1>
    <div class="bar-right">
      <button id="timelineBtn" class="btn-link" aria-label="Open Master Timeline" title="Master Timeline">Timeline</button>
      <button id="homeAddPhaseBtn" class="btn primary small" aria-label="Add Phase" title="+ Add Phase">+ Phase</button>
      <button id="overflowBtn" class="icon-btn" aria-label="More" title="More">⋯</button>
    </div>
  </header>

  <!-- Overflow Menu (global dev utilities) -->
  <div id="overflowMenu" class="menu" hidden>
    <button id="resetDataBtn" class="menu-item danger">Reset Data (seed)</button>
  </div>

  <main id="appRoot" class="app-root" role="main">
    <!-- HOME (PHASES) VIEW -->
    <section id="homeView" class="view active" aria-labelledby="homeHeading">
      <h2 id="homeHeading" class="sr-only">Phases</h2>
      <div id="phaseGrid" class="phase-grid"></div>
      <div id="homeEmpty" class="empty" hidden>
        <p>No bins yet. Add your first one.</p>
        <button id="emptyAddPhase" class="btn primary">+ Add Phase</button>
      </div>
    </section>

    <!-- PHASE DETAIL VIEW -->
    <section id="phaseView" class="view" aria-labelledby="phaseHeading">
      <h2 id="phaseHeading" class="sr-only">Phase Detail</h2>

      <div class="phase-header">
        <input id="phaseTitleInput" class="title-input" aria-label="Edit title" />
        <div class="phase-actions">
          <button id="phaseOptionsBtn" class="icon-btn" aria-label="Options" title="Options">⋯</button>
          <div id="phaseOptionsMenu" class="menu" hidden>
            <button id="renamePhaseBtn" class="menu-item">Rename</button>
            <button id="deletePhaseBtn" class="menu-item danger">Delete</button>
          </div>
        </div>
      </div>

      <div id="tasksList" class="tasks"></div>
      <div id="completedBlock" class="completed-block hidden">
        <button id="completedToggle" class="btn subtle wide">Completed <span id="completedCount">(0)</span></button>
        <div id="completedList" class="tasks small-pad"></div>
      </div>

      <div id="phaseEmpty" class="empty" hidden>No tasks yet. Tap + to add one.</div>

      <!-- Bottom Add Task FAB -->
      <button id="addTaskFab" class="fab" aria-label="Add Task" title="Add Task">＋</button>
    </section>

    <!-- TIMELINE VIEW -->
    <section id="timelineView" class="view" aria-labelledby="timelineHeading">
      <div class="timeline-header">
        <h2 id="timelineHeading" class="view-title">Master Timeline</h2>
        <div class="chip-row" role="tablist" aria-label="Timeline filter">
          <button class="chip" data-tf="all" role="tab" aria-selected="true">All</button>
          <button class="chip" data-tf="Pre‑Departure" role="tab">Pre‑Departure</button>
          <button class="chip" data-tf="Mid Prep" role="tab">Mid Prep</button>
          <button class="chip" data-tf="Final Out" role="tab">Final Out</button>
          <button class="chip" data-tf="Arrival (Hill AFB)" role="tab">Arrival</button>
        </div>
      </div>
      <div id="timelineList" class="timeline-list"></div>
      <div id="timelineEmpty" class="empty" hidden>No dated items yet.</div>
    </section>
  </main>

  <!-- Add/Edit Task Sheet -->
  <div id="sheetScrim" class="sheet-scrim" hidden></div>
  <section id="taskSheet" class="sheet" role="dialog" aria-modal="true" aria-labelledby="sheetTitle" hidden>
    <div class="sheet-card">
      <div class="sheet-head">
        <h3 id="sheetTitle" class="sheet-title">Add Task</h3>
        <button id="sheetClose" class="icon-btn" aria-label="Close">✕</button>
      </div>
      <div class="sheet-body">
        <label class="label" for="sheetPhase">Bin</label>
        <select id="sheetPhase" class="input"></select>

        <label class="label" for="sheetTitleInput">Title <span class="req">*</span></label>
        <input id="sheetTitleInput" class="input" placeholder="Task title" maxlength="200" />

        <label class="label" for="sheetDate">Due date</label>
        <div class="date-row">
          <input id="sheetDate" class="input" type="date" />
          <button id="sheetDateClear" class="btn subtle" type="button" aria-label="Clear date">×</button>
        </div>

        <label class="label" for="sheetDesc">Details</label>
        <textarea id="sheetDesc" class="input" rows="3" placeholder="Optional notes"></textarea>
      </div>
      <div class="sheet-actions">
        <button id="sheetCancel" class="btn">Cancel</button>
        <button id="sheetSave" class="btn primary">Save</button>
      </div>
    </div>
  </section>

  <!-- Toast -->
  <div id="toast" class="toast hidden" role="status" aria-live="polite">
    <span id="toastMsg"></span>
    <button id="toastUndo" class="btn link" hidden>Undo</button>
  </div>

  <script src="script.js"></script>
</body>
</html>
